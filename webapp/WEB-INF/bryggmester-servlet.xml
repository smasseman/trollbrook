<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:jee="http://www.springframework.org/schema/jee" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="
		http://www.springframework.org/schema/beans 
     	http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
     	http://www.springframework.org/schema/tx 
     	http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
    	http://www.springframework.org/schema/aop 
    	http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
    	http://www.springframework.org/schema/jms 
    	http://www.springframework.org/schema/jms/spring-jms-3.1.xsd
			http://www.springframework.org/schema/context 
			http://www.springframework.org/schema/context/spring-context-3.1.xsd
			http://www.springframework.org/schema/jee 
			http://www.springframework.org/schema/jee/spring-jee-3.1.xsd
			http://www.springframework.org/schema/util 
			http://www.springframework.org/schema/util/spring-util-3.1.xsd
			http://activemq.apache.org/schema/core 
			http://activemq.apache.org/schema/core/activemq-core-5.5.0.xsd
			http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd"

	default-lazy-init="false">

	<context:annotation-config />
	<context:component-scan base-package="se.trollbrook.bryggmester" />

	<bean id="multipartResolver"
		class="org.springframework.web.multipart.support.StandardServletMultipartResolver">
	</bean>

	<mvc:interceptors>
		<mvc:interceptor>
			<mvc:mapping path="/**/*.html" />
			<bean
				class="se.trollbrook.spring.web.servlet.interceptors.LogModelAndViewInterceptor" />
		</mvc:interceptor>
		<mvc:interceptor>
			<mvc:mapping path="/**/*.html" />
			<bean
				class="se.trollbrook.spring.web.servlet.interceptors.MessagesInterceptor" />
		</mvc:interceptor>
		<mvc:interceptor>
			<mvc:mapping path="/**/*.html" />
			<bean
				class="se.trollbrook.spring.web.servlet.interceptors.ModelObjectInserterInterceptor">
				<property name="attributeName" value="ctxRoot" />
				<property name="attributeValue" ref="ctxRoot" />

			</bean>
		</mvc:interceptor>
	</mvc:interceptors>

	<bean id="velocityEngine"
		class="org.springframework.ui.velocity.VelocityEngineFactoryBean"
		p:resourceLoaderPath="/WEB-INF/tmpl" p:configLocation="/WEB-INF/velocity.properties" />

	<bean id="velocityConfig"
		class="org.springframework.web.servlet.view.velocity.VelocityConfigurer"
		p:velocityEngine-ref="velocityEngine" />

	<bean id="viewResolver"
		class="org.springframework.web.servlet.view.velocity.VelocityViewResolver"
		p:suffix=".html" p:cache="true" p:exposeSpringMacroHelpers="true"
		p:toolboxConfigLocation="/WEB-INF/toolbox.xml"
		p:redirectContextRelative="false" p:contentType="text/html; charset=UTF-8" />

	<beans profile="dev">
		<bean id="ctxRoot" class="java.lang.String">
			<constructor-arg value="/bryggmester" />
		</bean>
		<bean id="extrarelay" class="se.trollbrook.bryggmester.Relay">
			<constructor-arg value="Extra" />
		</bean>
		<bean id="heatrelay" class="se.trollbrook.bryggmester.Relay">
			<constructor-arg value="Heat" />
		</bean>
		<bean id="pumprelay" class="se.trollbrook.bryggmester.Relay">
			<constructor-arg value="Pump" />
		</bean>
		<bean id="temperatureFile" class="java.lang.String">
			<constructor-arg value="/tmp/temp.txt" />
		</bean>
		<bean id="databasedirectory" class="java.io.File">
			<constructor-arg value="/Users/jorgen/git/smasseman/trollbrook/recipes" />
		</bean>
	</beans>

	<beans profile="pi">
		<bean id="ctxRoot" class="java.lang.String">
			<constructor-arg value="" />
		</bean>
		<bean id="extrarelay" class="se.trollbrook.bryggmester.RpiRelay">
			<constructor-arg value="Extra" />
			<constructor-arg value="04" />
		</bean>
		<bean id="heatrelay" class="se.trollbrook.bryggmester.RpiRelay">
			<constructor-arg value="Heat" />
			<constructor-arg value="00" />
		</bean>
		<bean id="pumprelay" class="se.trollbrook.bryggmester.RpiRelay">
			<constructor-arg value="Pump" />
			<constructor-arg value="01" />
		</bean>
		<bean id="temperatureFile" class="java.lang.String">
			<constructor-arg value="/sys/bus/w1/devices/28-000004e48339/w1_slave" />
		</bean>
		<bean id="databasedirectory" class="java.io.File">
			<constructor-arg value="/var/trollbrook/bryggmester/recipes" />
		</bean>
	</beans>

</beans>
